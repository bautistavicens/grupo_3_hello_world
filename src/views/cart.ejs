<!DOCTYPE html>
<html lang="es">
    <%- include('./partials/head') %>
<body>
    <%- include('./partials/header') %>
    <%- include('./partials/mobileNavBar') %>
   <main>
       <section class="main-title-container">
            <div class="style-div">
                <div class="flex-container">
                    <article class="sub-container-1">
                        <h4 class="item-title">Carrito de compras</h4>
                        <p class="item">"cantidad" productos</p>
                    </article>
                    <article class="sub-container-2">
                        <span class="lock-title-span">
                            <i class="fa-solid fa-lock"></i>
                            <h4 class="item">Sitio</h4>
                        </span>
                        <p class="item">protegido</p>
                    </article>
                </div>
            </div>
        </section>
        <section>
            <% if (cart.Products[0] == null) { %>
                <article class="cart-empty-product-container">
                    <h3>Vacío</h3>
                </article>
            <% } else { %>
                <% cart.Products.forEach(product => { %>
                    <article class="product-container">
                        <section class="sub-container-botonera-container">
                            <article class="sub-container-1">
                                <img class="product-img"src="/images/products/<%= product.productImages[0].image_path %>" alt="Producto">
                                <div class="product-title-off-price-conteiner">
                                    <h3 class="product-title"><%= product.productBrand.name %></h3>
                                    <%  if (product.discount_percentage > 0) { %>
                                        <p class="product-off"> <%= product.discount_percentage %>% Off</p>
                                    <% } %>
                                    <p class="product-price-mobile"><%= product.price %></p>
                                </div>
                            </article>
                            <article class="botonera">
                                <form action="/cart/<%= product.id %>/eliminar?_method=DELETE" method="POST" class="buttons-container">
                                    <button><i class="fa-solid fa-trash" id="btn-icon"></i>Eliminar</button>
                                </form>
                                <button><i class="fa-solid fa-bookmark" id="btn-icon"></i>Agregar a favoritos</button>
                            </article>
                            
                        </section>
                        <section class="description-container">
                            <div  class="description-subcontainer">
                                <p class="title">Color: </p>
                                <span class="value"><%= product.color %></span>
                            </div>
                            <div class="description-subcontainer">
                                <p class="title">Talle: </p>
                                <% product.Sizes.forEach(size => { %>
                                    <% if (size.id == product.CartProducts.size_id) { %>
                                        <span class="value"><%=size.value + " " + size.type%></span>
                                    <% } %>
                                <% }) %> 
                            </div>
                            <div class="description-subcontainer">
                                <p class="title">Cantidad:</p> 
                                <select name="cantidad-value" id="select-cantidad">
                                <% [1,2,3,4,5].forEach(number => { %>
                                    <% if (number != product.CartProducts.quantity) { %>
                                        <option value=<%= number %> ><%= number %></option>
                                    <% } else { %>
                                        <option value=<%= number %> selected="selected" ><%= number %></option>
                                    <% } %>
                                <% }) %>
                                </select>
                            </div>
                        </section>
                        <section class="price-container-desktop">
                            <div class="sub-container-1">
                                <p class="title">Precio unitario:</p>
                                <!--If product has %Off-->
                                <% if (product.discount_percentage > 0) { %>
                                    <div>
                                        <!--Price without discount-->
                                        <p class="price"><del> $<%= product.price %> </del></p>

                                    </div>
                                    <!--Price with discount-->
                                    <p class="price-with-discount">
                                        $<%= product.price - ((product.price * product.discount_percentage) / 100) %> 
                                    </p>
                                        
                                <!--If not-->
                                <% } else { %>
                                    <!--Price-->
                                    <p class="price"> $<%= product.price %> </p>
                                <% } %>
                            </div>
                            <div class="sub-container-2">
                                <p class="title">Total:</p>
                                <!--If product has %Off-->
                                <% if (product.discount_percentage > 0) { %>
                                    <!--Price with discount-->
                                    <p class="total">
                                        $<%= (product.price - ((product.price * product.discount_percentage) / 100)) * product.CartProducts.quantity %> 
                                    </p>
                                        
                                <!--If not-->
                                <% } else { %>
                                    <!--Price-->
                                    <p class="total">$<%= product.price * product.CartProducts.quantity %>  </p>
                                <% } %>
                                
                            </div>
                        </section>
                    </article>
                <% }) %>
            <% } %>
        </section>
        <section class="finalizar-compra-section">
            <section class="discount-container">
                <form action="/discount-code" method="POST">
                    <label for="discount-code">Codigo de descuento</label>
                    <input type="text" class="discount-code">
                    <button>Agregar</button>
                </form>
                <img src="/images/cart/banner_cuotas_tarjetas_bottom.jpg" alt="Banner - Tarjetas - Cuotas sin interes" class="banner-cuotas-tarjetas">
            </section>
            <section class="precio-and-btn-container">
                <div class="subtotal-container">
                    <p class="title">Subtotal:</p>
                    <p class="price">$$$$$$$$$</p>
                </div>
                <div class="precio-container">
                    <p class="title">Total:</p>
                    <p class="price">$$$$$$$$$</p>
                </div>
                <div class="iva-container">
                    <p class="iva">IVA incluido</p>
                </div>
                <button class="proceder-compra-btn">Proceder a la compra</button>
            </section>
       </section>
    </main>
   <footer class="cart-footer">
        <div class="footer-container">
            <div class="sitio-seguro-container">
                <span class="lock-title-span">
                    <h4>Compra segura</h4>
                    <i class="fa-solid fa-lock"></i>   
                </span>
                <p> Sitio seguro con criptografía (SSL)</p>
            </div>
            <img src="/images/logo.svg" class="logo-img" alt="Logo">
        </div>
   </footer>
</body>
</html>